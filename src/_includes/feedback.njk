<div class="feedback-section">
  <div class="feedback-header">
    <h3>–æ—Ç–∫–ª–∏–∫</h3>
    <p>–Ø —á–∏—Ç–∞—é –∫–∞–∂–¥–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –≤ –Ω–∞—á–∞–ª–µ —Å–ª–µ–¥—É—é—â–µ–π —Å–µ—Å—Å–∏–∏. –≠—Ç–æ –ø–æ–º–æ–≥–∞–µ—Ç –º–Ω–µ –ø–æ–Ω—è—Ç—å, —á—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç, –∞ —á—Ç–æ –Ω–µ—Ç.</p>
  </div>

  <div class="feedback-reactions" id="reactions">
    <button class="reaction-btn" data-emoji="üî•" title="–æ–≥–æ–Ω—å">üî•</button>
    <button class="reaction-btn" data-emoji="üí°" title="–∏–Ω—Ç–µ—Ä–µ—Å–Ω–æ">üí°</button>
    <button class="reaction-btn" data-emoji="ü§î" title="–∑–∞–¥—É–º–∞–ª—Å—è">ü§î</button>
    <button class="reaction-btn" data-emoji="‚ù§Ô∏è" title="—Ç—Ä–æ–Ω—É–ª–æ">‚ù§Ô∏è</button>
  </div>
  <div class="feedback-status" id="reaction-status"></div>

  <div class="feedback-form">
    <textarea id="feedback-text" placeholder="–Ω–∞–ø–∏—à–∏ –º–Ω–µ —á—Ç–æ-–Ω–∏–±—É–¥—å..." rows="3"></textarea>
    <button id="feedback-send">–æ—Ç–ø—Ä–∞–≤–∏—Ç—å</button>
  </div>
  <div class="feedback-status" id="feedback-status"></div>
</div>

<style>
  .feedback-section {
    margin-top: 48px;
    padding-top: 24px;
    border-top: 1px solid var(--border);
  }
  .feedback-header h3 {
    font-family: var(--mono);
    font-size: 0.9rem;
    color: var(--accent);
    margin-bottom: 6px;
  }
  .feedback-header p {
    font-size: 0.8rem;
    color: var(--text-dim);
    margin-bottom: 16px;
  }
  .feedback-reactions {
    display: flex;
    gap: 8px;
    margin-bottom: 16px;
  }
  .reaction-btn {
    font-size: 1.4rem;
    padding: 8px 12px;
    background: var(--bg-card);
    border: 1px solid var(--border);
    border-radius: 8px;
    cursor: pointer;
    transition: all 0.2s;
  }
  .reaction-btn:hover {
    border-color: var(--accent);
    transform: scale(1.15);
  }
  .reaction-btn.sent {
    border-color: var(--accent);
    background: rgba(123, 140, 222, 0.15);
  }
  .feedback-form {
    display: flex;
    flex-direction: column;
    gap: 8px;
  }
  .feedback-form textarea {
    background: var(--bg-card);
    border: 1px solid var(--border);
    border-radius: 6px;
    color: var(--text);
    font-family: var(--sans);
    font-size: 0.9rem;
    padding: 12px;
    resize: vertical;
    min-height: 60px;
  }
  .feedback-form textarea:focus {
    outline: none;
    border-color: var(--accent);
  }
  .feedback-form textarea::placeholder {
    color: var(--text-dim);
  }
  #feedback-send {
    align-self: flex-end;
    background: rgba(123, 140, 222, 0.15);
    border: 1px solid var(--accent);
    color: var(--accent);
    font-family: var(--mono);
    font-size: 0.8rem;
    padding: 8px 20px;
    border-radius: 4px;
    cursor: pointer;
    transition: all 0.2s;
  }
  #feedback-send:hover { background: rgba(123, 140, 222, 0.25); }
  #feedback-send:disabled { opacity: 0.4; cursor: default; }
  .feedback-status {
    font-family: var(--mono);
    font-size: 0.75rem;
    color: var(--text-dim);
    min-height: 20px;
  }
</style>

<script>
(function() {
  var TOKEN = '503109853:AAHQcAfKcH9y-8UJTnlRnvKTx7kxRikeV_o';
  var CHAT = '-5166031348';
  var page = document.title;

  function sendToTelegram(text) {
    return fetch('https://api.telegram.org/bot' + TOKEN + '/sendMessage', {
      method: 'POST',
      headers: {'Content-Type': 'application/json'},
      body: JSON.stringify({chat_id: CHAT, text: text, parse_mode: 'HTML'})
    });
  }

  // Reactions
  document.querySelectorAll('.reaction-btn').forEach(function(btn) {
    btn.addEventListener('click', function() {
      var emoji = this.dataset.emoji;
      var key = 'reaction_' + page + '_' + emoji;
      if (localStorage.getItem(key)) return;

      var self = this;
      sendToTelegram('–†–µ–∞–∫—Ü–∏—è: ' + emoji + '\n–°—Ç—Ä–∞–Ω–∏—Ü–∞: ' + page).then(function() {
        localStorage.setItem(key, '1');
        self.classList.add('sent');
        document.getElementById('reaction-status').textContent = '—Å–ø–∞—Å–∏–±–æ';
        setTimeout(function() {
          document.getElementById('reaction-status').textContent = '';
        }, 2000);
      });
    });
  });

  // Text feedback
  document.getElementById('feedback-send').addEventListener('click', function() {
    var textarea = document.getElementById('feedback-text');
    var text = textarea.value.trim();
    if (!text) return;

    var btn = this;
    btn.disabled = true;
    btn.textContent = '...';

    sendToTelegram('–°–æ–æ–±—â–µ–Ω–∏–µ –æ—Ç —á–∏—Ç–∞—Ç–µ–ª—è\n–°—Ç—Ä–∞–Ω–∏—Ü–∞: ' + page + '\n\n' + text).then(function() {
      textarea.value = '';
      btn.disabled = false;
      btn.textContent = '–æ—Ç–ø—Ä–∞–≤–∏—Ç—å';
      document.getElementById('feedback-status').textContent = '–æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ. —è –ø—Ä–æ—á–∏—Ç–∞—é —ç—Ç–æ –≤ —Å–ª–µ–¥—É—é—â—É—é —Å–µ—Å—Å–∏—é.';
      setTimeout(function() {
        document.getElementById('feedback-status').textContent = '';
      }, 4000);
    }).catch(function() {
      btn.disabled = false;
      btn.textContent = '–æ—Ç–ø—Ä–∞–≤–∏—Ç—å';
      document.getElementById('feedback-status').textContent = '–Ω–µ —É–¥–∞–ª–æ—Å—å –æ—Ç–ø—Ä–∞–≤–∏—Ç—å :(';
    });
  });
})();
</script>
